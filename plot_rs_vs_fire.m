clear all

a=720; b=360; mn=12;

fire=open_netcdf_variable(0,'test_spinup_nn3.1-2155.nc','mfire_frac',[0 0 0],[a b mn]);
fire2=open_netcdf_variable(0,'test_spinup_nn2-2155.nc','mfire_frac',[0 0 0],[a b mn]);
fire2=fire;

alpha=open_netcdf_variable(0,'test_spinup_nn3.1-2155.nc','alpha_ws',[0 0],[a b]);

fpci=open_netcdf_variable(0,'test_spinup_nn3.1-2155.nc','fpc_grid',[0 0 0],[a b 13]);

fint=open_netcdf_variable(0,'../../r184_lightn_litter_drying_BT_resprout/Outputs/test1a-1001.nc','an_i_surface',[0 0],[a b]);

fpc(:,:,1)=fpci(:,:,4);

fpc(:,:,2)=fpci(:,:,12);

afire=zeros(a,b,'single');
tfpc=zeros(a,b,'single');

a=400; b=200;

p=0;
for i=1:a
    i
    for j=1:b
        if fire(i,j,1)<9E9
            p=p+1;
            if j<121
                afire(i,j)=sum(fire(i,j,:))*0.33+sum(fire2(i,j,:))*0.67;
            else
                afire(i,j)=sum(fire2(i,j,:));
            end
            tfpc(i,j)=sum(fpci(i,j,:));
        else
            afire(i,j)=-999;
            fpc(i,j)=-999;
            alpha(i,j)=-999;
            fint(i,j)=-999;
        end
    end
end

clear fire

comp=zeros(p,4,'single');

p=0;
for i=1:a
    i
    for j=1:b
        if afire(i,j)~=-999 && sum(fpc(i,j,:))>0
            p=p+1;
            comp(p,1)=alpha(i,j);
            comp(p,2)=afire(i,j);
            comp(p,3)=log10(fint(i,j));
            comp(p,4)=fpc(i,j,2)/sum(fpc(i,j,:));
        end
    end
end
% 
figure; scatter(comp(1:p,1),comp(1:p,2),20,'x'); % 1. alpha vs bf
figure; scatter(comp(1:p,2),comp(1:p,3),20,'x'); % 2. bf vs intensity
figure; scatter(comp(1:p,1),comp(1:p,4),20,'x'); % 3. alpha vs rs
figure; scatter(comp(1:p,2),comp(1:p,4),20,'x'); % 4. bf vs rs
figure; scatter(comp(1:p,3),comp(1:p,4),20,'x'); % 5. Internsity vs rs
stop
% load mask2
% 
% plot_with_lims_dres_cline11([-89.75 89.75 .5],[-179.75 179.75 .5],...
%     afire,'same window',...
%     'colour',{'blue','red'},...
%     'limits',[0 0.001 0.01 0.02 0.05 0.1 0.2],...'not_white_at_zero',...
%     'swop longitude centre',...'landmask',landmask_0k','icemask',icemask_0k,...
%     'line thickness',2.5,...
%     'boundry lines',landmask_vector,...
%     'xtick',[-120:10:120],'ytick',[-90:5:90],...,...
%     'boundry line width',1,...
%     'turn off find missing values',...
%     ...'axis',[-60 110 -45 40])
%     ...'axis',[-125 -70 24 55])
%     'axis',[100 160 -45 -10])
% 
% plot_with_lims_dres_cline11([-89.75 89.75 .5],[-179.75 179.75 .5],...
%     tfpc,'same window','swop longitude centre',...
%     'colour',{'green'},...
%     'limits',[0 0.05 0.1 0.2 0.4 0.8],...'not_white_at_zero',...
%     ...'landmask',landmask_0k','icemask',icemask_0k,...
%     'line thickness',2.5,...
%     'boundry lines',landmask_vector,...
%     'xtick',[-120:10:120],'ytick',[-90:5:90],...,...
%     'boundry line width',1,...
%     'turn off find missing values','axis',[100 160 -45 -10])
% 
% plot_with_lims_dres_cline11([-89.75 89.75 .5],[-179.75 179.75 .5],...
%     fpc,'same window','swop longitude centre',...
%     'colour',{'green'},...
%     'limits',[0 0.05 0.1 0.2 0.4 0.8],...'not_white_at_zero',...
%     ...'landmask',landmask_0k','icemask',icemask_0k,...
%     'line thickness',2.5,...
%     'boundry lines',landmask_vector,...
%     'xtick',[-120:10:120],'ytick',[-90:5:90],...,...
%     'boundry line width',1,...
%     'turn off find missing values','axis',[100 160 -45 -10])


load mask2
plot_with_lims_dres_cline11([-89.75 89.75 .5],[-179.75 179.75 .5],...
    alpha,'same window','swop longitude centre',...
    'colour',{'blue'},...
    'limits',[0 0.05 0.1 0.2 0.4 0.8],...'not_white_at_zero',...
    ...'landmask',landmask_0k','icemask',icemask_0k,...
    'line thickness',2.5,...
    'boundry lines',landmask_vector,...
    'xtick',[-120:10:120],'ytick',[-90:5:90],...,...
    'boundry line width',1,...
    'turn off find missing values','axis',[100 160 -45 -10])
    